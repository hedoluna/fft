// Bit-reversal lookup table for size 64
private static final int[] BIT_REVERSAL_TABLE = {
    0, 32, 16, 48, 8, 40, 24, 56, 4, 36, 20, 52, 12, 44, 28, 60,  // 0-15
    2, 34, 18, 50, 10, 42, 26, 58, 6, 38, 22, 54, 14, 46, 30, 62,  // 16-31
    1, 33, 17, 49, 9, 41, 25, 57, 5, 37, 21, 53, 13, 45, 29, 61,  // 32-47
    3, 35, 19, 51, 11, 43, 27, 59, 7, 39, 23, 55, 15, 47, 31, 63
};

// Bit-reversal swaps for size 64
// Swap 1 <-> 32
// Swap 2 <-> 16
// Swap 3 <-> 48
// Swap 4 <-> 8
// Swap 5 <-> 40
// Swap 6 <-> 24
// Swap 7 <-> 56
// Swap 9 <-> 36
// Swap 10 <-> 20
// Swap 11 <-> 52
// Swap 13 <-> 44
// Swap 14 <-> 28
// Swap 15 <-> 60
// Swap 17 <-> 34
// Swap 19 <-> 50
// Swap 21 <-> 42
// Swap 22 <-> 26
// Swap 23 <-> 58
// Swap 25 <-> 38
// Swap 27 <-> 54
// Swap 29 <-> 46
// Swap 31 <-> 62
// Swap 35 <-> 49
// Swap 37 <-> 41
// Swap 39 <-> 57
// Swap 43 <-> 53
// Swap 47 <-> 61
// Swap 55 <-> 59

// Bit-reversal lookup table for size 128
private static final int[] BIT_REVERSAL_TABLE = {
    0, 64, 32, 96, 16, 80, 48, 112, 8, 72, 40, 104, 24, 88, 56, 120,  // 0-15
    4, 68, 36, 100, 20, 84, 52, 116, 12, 76, 44, 108, 28, 92, 60, 124,  // 16-31
    2, 66, 34, 98, 18, 82, 50, 114, 10, 74, 42, 106, 26, 90, 58, 122,  // 32-47
    6, 70, 38, 102, 22, 86, 54, 118, 14, 78, 46, 110, 30, 94, 62, 126,  // 48-63
    1, 65, 33, 97, 17, 81, 49, 113, 9, 73, 41, 105, 25, 89, 57, 121,  // 64-79
    5, 69, 37, 101, 21, 85, 53, 117, 13, 77, 45, 109, 29, 93, 61, 125,  // 80-95
    3, 67, 35, 99, 19, 83, 51, 115, 11, 75, 43, 107, 27, 91, 59, 123,  // 96-111
    7, 71, 39, 103, 23, 87, 55, 119, 15, 79, 47, 111, 31, 95, 63, 127
};

// Bit-reversal swaps for size 128
// Swap 1 <-> 64
// Swap 2 <-> 32
// Swap 3 <-> 96
// Swap 4 <-> 16
// Swap 5 <-> 80
// Swap 6 <-> 48
// Swap 7 <-> 112
// Swap 9 <-> 72
// Swap 10 <-> 40
// Swap 11 <-> 104
// Swap 12 <-> 24
// Swap 13 <-> 88
// Swap 14 <-> 56
// Swap 15 <-> 120
// Swap 17 <-> 68
// Swap 18 <-> 36
// Swap 19 <-> 100
// Swap 21 <-> 84
// Swap 22 <-> 52
// Swap 23 <-> 116
// Swap 25 <-> 76
// Swap 26 <-> 44
// Swap 27 <-> 108
// Swap 29 <-> 92
// Swap 30 <-> 60
// Swap 31 <-> 124
// Swap 33 <-> 66
// Swap 35 <-> 98
// Swap 37 <-> 82
// Swap 38 <-> 50
// Swap 39 <-> 114
// Swap 41 <-> 74
// Swap 43 <-> 106
// Swap 45 <-> 90
// Swap 46 <-> 58
// Swap 47 <-> 122
// Swap 49 <-> 70
// Swap 51 <-> 102
// Swap 53 <-> 86
// Swap 55 <-> 118
// Swap 57 <-> 78
// Swap 59 <-> 110
// Swap 61 <-> 94
// Swap 63 <-> 126
// Swap 67 <-> 97
// Swap 69 <-> 81
// Swap 71 <-> 113
// Swap 75 <-> 105
// Swap 77 <-> 89
// Swap 79 <-> 121
// Swap 83 <-> 101
// Swap 87 <-> 117
// Swap 91 <-> 109
// Swap 95 <-> 125
// Swap 103 <-> 115
// Swap 111 <-> 123

// Bit-reversal lookup table for size 256
private static final int[] BIT_REVERSAL_TABLE = {
    0, 128, 64, 192, 32, 160, 96, 224, 16, 144, 80, 208, 48, 176, 112, 240,  // 0-15
    8, 136, 72, 200, 40, 168, 104, 232, 24, 152, 88, 216, 56, 184, 120, 248,  // 16-31
    4, 132, 68, 196, 36, 164, 100, 228, 20, 148, 84, 212, 52, 180, 116, 244,  // 32-47
    12, 140, 76, 204, 44, 172, 108, 236, 28, 156, 92, 220, 60, 188, 124, 252,  // 48-63
    2, 130, 66, 194, 34, 162, 98, 226, 18, 146, 82, 210, 50, 178, 114, 242,  // 64-79
    10, 138, 74, 202, 42, 170, 106, 234, 26, 154, 90, 218, 58, 186, 122, 250,  // 80-95
    6, 134, 70, 198, 38, 166, 102, 230, 22, 150, 86, 214, 54, 182, 118, 246,  // 96-111
    14, 142, 78, 206, 46, 174, 110, 238, 30, 158, 94, 222, 62, 190, 126, 254,  // 112-127
    1, 129, 65, 193, 33, 161, 97, 225, 17, 145, 81, 209, 49, 177, 113, 241,  // 128-143
    9, 137, 73, 201, 41, 169, 105, 233, 25, 153, 89, 217, 57, 185, 121, 249,  // 144-159
    5, 133, 69, 197, 37, 165, 101, 229, 21, 149, 85, 213, 53, 181, 117, 245,  // 160-175
    13, 141, 77, 205, 45, 173, 109, 237, 29, 157, 93, 221, 61, 189, 125, 253,  // 176-191
    3, 131, 67, 195, 35, 163, 99, 227, 19, 147, 83, 211, 51, 179, 115, 243,  // 192-207
    11, 139, 75, 203, 43, 171, 107, 235, 27, 155, 91, 219, 59, 187, 123, 251,  // 208-223
    7, 135, 71, 199, 39, 167, 103, 231, 23, 151, 87, 215, 55, 183, 119, 247,  // 224-239
    15, 143, 79, 207, 47, 175, 111, 239, 31, 159, 95, 223, 63, 191, 127, 255
};

// Bit-reversal swaps for size 256
// Swap 1 <-> 128
// Swap 2 <-> 64
// Swap 3 <-> 192
// Swap 4 <-> 32
// Swap 5 <-> 160
// Swap 6 <-> 96
// Swap 7 <-> 224
// Swap 8 <-> 16
// Swap 9 <-> 144
// Swap 10 <-> 80
// Swap 11 <-> 208
// Swap 12 <-> 48
// Swap 13 <-> 176
// Swap 14 <-> 112
// Swap 15 <-> 240
// Swap 17 <-> 136
// Swap 18 <-> 72
// Swap 19 <-> 200
// Swap 20 <-> 40
// Swap 21 <-> 168
// Swap 22 <-> 104
// Swap 23 <-> 232
// Swap 25 <-> 152
// Swap 26 <-> 88
// Swap 27 <-> 216
// Swap 28 <-> 56
// Swap 29 <-> 184
// Swap 30 <-> 120
// Swap 31 <-> 248
// Swap 33 <-> 132
// Swap 34 <-> 68
// Swap 35 <-> 196
// Swap 37 <-> 164
// Swap 38 <-> 100
// Swap 39 <-> 228
// Swap 41 <-> 148
// Swap 42 <-> 84
// Swap 43 <-> 212
// Swap 44 <-> 52
// Swap 45 <-> 180
// Swap 46 <-> 116
// Swap 47 <-> 244
// Swap 49 <-> 140
// Swap 50 <-> 76
// Swap 51 <-> 204
// Swap 53 <-> 172
// Swap 54 <-> 108
// Swap 55 <-> 236
// Swap 57 <-> 156
// Swap 58 <-> 92
// Swap 59 <-> 220
// Swap 61 <-> 188
// Swap 62 <-> 124
// Swap 63 <-> 252
// Swap 65 <-> 130
// Swap 67 <-> 194
// Swap 69 <-> 162
// Swap 70 <-> 98
// Swap 71 <-> 226
// Swap 73 <-> 146
// Swap 74 <-> 82
// Swap 75 <-> 210
// Swap 77 <-> 178
// Swap 78 <-> 114
// Swap 79 <-> 242
// Swap 81 <-> 138
// Swap 83 <-> 202
// Swap 85 <-> 170
// Swap 86 <-> 106
// Swap 87 <-> 234
// Swap 89 <-> 154
// Swap 91 <-> 218
// Swap 93 <-> 186
// Swap 94 <-> 122
// Swap 95 <-> 250
// Swap 97 <-> 134
// Swap 99 <-> 198
// Swap 101 <-> 166
// Swap 103 <-> 230
// Swap 105 <-> 150
// Swap 107 <-> 214
// Swap 109 <-> 182
// Swap 110 <-> 118
// Swap 111 <-> 246
// Swap 113 <-> 142
// Swap 115 <-> 206
// Swap 117 <-> 174
// Swap 119 <-> 238
// Swap 121 <-> 158
// Swap 123 <-> 222
// Swap 125 <-> 190
// Swap 127 <-> 254
// Swap 131 <-> 193
// Swap 133 <-> 161
// Swap 135 <-> 225
// Swap 137 <-> 145
// Swap 139 <-> 209
// Swap 141 <-> 177
// Swap 143 <-> 241
// Swap 147 <-> 201
// Swap 149 <-> 169
// Swap 151 <-> 233
// Swap 155 <-> 217
// Swap 157 <-> 185
// Swap 159 <-> 249
// Swap 163 <-> 197
// Swap 167 <-> 229
// Swap 171 <-> 213
// Swap 173 <-> 181
// Swap 175 <-> 245
// Swap 179 <-> 205
// Swap 183 <-> 237
// Swap 187 <-> 221
// Swap 191 <-> 253
// Swap 199 <-> 227
// Swap 203 <-> 211
// Swap 207 <-> 243
// Swap 215 <-> 235
// Swap 223 <-> 251
// Swap 239 <-> 247

// Bit-reversal lookup table for size 512
private static final int[] BIT_REVERSAL_TABLE = {
    0, 256, 128, 384, 64, 320, 192, 448, 32, 288, 160, 416, 96, 352, 224, 480,  // 0-15
    16, 272, 144, 400, 80, 336, 208, 464, 48, 304, 176, 432, 112, 368, 240, 496,  // 16-31
    8, 264, 136, 392, 72, 328, 200, 456, 40, 296, 168, 424, 104, 360, 232, 488,  // 32-47
    24, 280, 152, 408, 88, 344, 216, 472, 56, 312, 184, 440, 120, 376, 248, 504,  // 48-63
    4, 260, 132, 388, 68, 324, 196, 452, 36, 292, 164, 420, 100, 356, 228, 484,  // 64-79
    20, 276, 148, 404, 84, 340, 212, 468, 52, 308, 180, 436, 116, 372, 244, 500,  // 80-95
    12, 268, 140, 396, 76, 332, 204, 460, 44, 300, 172, 428, 108, 364, 236, 492,  // 96-111
    28, 284, 156, 412, 92, 348, 220, 476, 60, 316, 188, 444, 124, 380, 252, 508,  // 112-127
    2, 258, 130, 386, 66, 322, 194, 450, 34, 290, 162, 418, 98, 354, 226, 482,  // 128-143
    18, 274, 146, 402, 82, 338, 210, 466, 50, 306, 178, 434, 114, 370, 242, 498,  // 144-159
    10, 266, 138, 394, 74, 330, 202, 458, 42, 298, 170, 426, 106, 362, 234, 490,  // 160-175
    26, 282, 154, 410, 90, 346, 218, 474, 58, 314, 186, 442, 122, 378, 250, 506,  // 176-191
    6, 262, 134, 390, 70, 326, 198, 454, 38, 294, 166, 422, 102, 358, 230, 486,  // 192-207
    22, 278, 150, 406, 86, 342, 214, 470, 54, 310, 182, 438, 118, 374, 246, 502,  // 208-223
    14, 270, 142, 398, 78, 334, 206, 462, 46, 302, 174, 430, 110, 366, 238, 494,  // 224-239
    30, 286, 158, 414, 94, 350, 222, 478, 62, 318, 190, 446, 126, 382, 254, 510,  // 240-255
    1, 257, 129, 385, 65, 321, 193, 449, 33, 289, 161, 417, 97, 353, 225, 481,  // 256-271
    17, 273, 145, 401, 81, 337, 209, 465, 49, 305, 177, 433, 113, 369, 241, 497,  // 272-287
    9, 265, 137, 393, 73, 329, 201, 457, 41, 297, 169, 425, 105, 361, 233, 489,  // 288-303
    25, 281, 153, 409, 89, 345, 217, 473, 57, 313, 185, 441, 121, 377, 249, 505,  // 304-319
    5, 261, 133, 389, 69, 325, 197, 453, 37, 293, 165, 421, 101, 357, 229, 485,  // 320-335
    21, 277, 149, 405, 85, 341, 213, 469, 53, 309, 181, 437, 117, 373, 245, 501,  // 336-351
    13, 269, 141, 397, 77, 333, 205, 461, 45, 301, 173, 429, 109, 365, 237, 493,  // 352-367
    29, 285, 157, 413, 93, 349, 221, 477, 61, 317, 189, 445, 125, 381, 253, 509,  // 368-383
    3, 259, 131, 387, 67, 323, 195, 451, 35, 291, 163, 419, 99, 355, 227, 483,  // 384-399
    19, 275, 147, 403, 83, 339, 211, 467, 51, 307, 179, 435, 115, 371, 243, 499,  // 400-415
    11, 267, 139, 395, 75, 331, 203, 459, 43, 299, 171, 427, 107, 363, 235, 491,  // 416-431
    27, 283, 155, 411, 91, 347, 219, 475, 59, 315, 187, 443, 123, 379, 251, 507,  // 432-447
    7, 263, 135, 391, 71, 327, 199, 455, 39, 295, 167, 423, 103, 359, 231, 487,  // 448-463
    23, 279, 151, 407, 87, 343, 215, 471, 55, 311, 183, 439, 119, 375, 247, 503,  // 464-479
    15, 271, 143, 399, 79, 335, 207, 463, 47, 303, 175, 431, 111, 367, 239, 495,  // 480-495
    31, 287, 159, 415, 95, 351, 223, 479, 63, 319, 191, 447, 127, 383, 255, 511
};

// Bit-reversal swaps for size 512
// Swap 1 <-> 256
// Swap 2 <-> 128
// Swap 3 <-> 384
// Swap 4 <-> 64
// Swap 5 <-> 320
// Swap 6 <-> 192
// Swap 7 <-> 448
// Swap 8 <-> 32
// Swap 9 <-> 288
// Swap 10 <-> 160
// Swap 11 <-> 416
// Swap 12 <-> 96
// Swap 13 <-> 352
// Swap 14 <-> 224
// Swap 15 <-> 480
// Swap 17 <-> 272
// Swap 18 <-> 144
// Swap 19 <-> 400
// Swap 20 <-> 80
// Swap 21 <-> 336
// Swap 22 <-> 208
// Swap 23 <-> 464
// Swap 24 <-> 48
// Swap 25 <-> 304
// Swap 26 <-> 176
// Swap 27 <-> 432
// Swap 28 <-> 112
// Swap 29 <-> 368
// Swap 30 <-> 240
// Swap 31 <-> 496
// Swap 33 <-> 264
// Swap 34 <-> 136
// Swap 35 <-> 392
// Swap 36 <-> 72
// Swap 37 <-> 328
// Swap 38 <-> 200
// Swap 39 <-> 456
// Swap 41 <-> 296
// Swap 42 <-> 168
// Swap 43 <-> 424
// Swap 44 <-> 104
// Swap 45 <-> 360
// Swap 46 <-> 232
// Swap 47 <-> 488
// Swap 49 <-> 280
// Swap 50 <-> 152
// Swap 51 <-> 408
// Swap 52 <-> 88
// Swap 53 <-> 344
// Swap 54 <-> 216
// Swap 55 <-> 472
// Swap 57 <-> 312
// Swap 58 <-> 184
// Swap 59 <-> 440
// Swap 60 <-> 120
// Swap 61 <-> 376
// Swap 62 <-> 248
// Swap 63 <-> 504
// Swap 65 <-> 260
// Swap 66 <-> 132
// Swap 67 <-> 388
// Swap 69 <-> 324
// Swap 70 <-> 196
// Swap 71 <-> 452
// Swap 73 <-> 292
// Swap 74 <-> 164
// Swap 75 <-> 420
// Swap 76 <-> 100
// Swap 77 <-> 356
// Swap 78 <-> 228
// Swap 79 <-> 484
// Swap 81 <-> 276
// Swap 82 <-> 148
// Swap 83 <-> 404
// Swap 85 <-> 340
// Swap 86 <-> 212
// Swap 87 <-> 468
// Swap 89 <-> 308
// Swap 90 <-> 180
// Swap 91 <-> 436
// Swap 92 <-> 116
// Swap 93 <-> 372
// Swap 94 <-> 244
// Swap 95 <-> 500
// Swap 97 <-> 268
// Swap 98 <-> 140
// Swap 99 <-> 396
// Swap 101 <-> 332
// Swap 102 <-> 204
// Swap 103 <-> 460
// Swap 105 <-> 300
// Swap 106 <-> 172
// Swap 107 <-> 428
// Swap 109 <-> 364
// Swap 110 <-> 236
// Swap 111 <-> 492
// Swap 113 <-> 284
// Swap 114 <-> 156
// Swap 115 <-> 412
// Swap 117 <-> 348
// Swap 118 <-> 220
// Swap 119 <-> 476
// Swap 121 <-> 316
// Swap 122 <-> 188
// Swap 123 <-> 444
// Swap 125 <-> 380
// Swap 126 <-> 252
// Swap 127 <-> 508
// Swap 129 <-> 258
// Swap 131 <-> 386
// Swap 133 <-> 322
// Swap 134 <-> 194
// Swap 135 <-> 450
// Swap 137 <-> 290
// Swap 138 <-> 162
// Swap 139 <-> 418
// Swap 141 <-> 354
// Swap 142 <-> 226
// Swap 143 <-> 482
// Swap 145 <-> 274
// Swap 147 <-> 402
// Swap 149 <-> 338
// Swap 150 <-> 210
// Swap 151 <-> 466
// Swap 153 <-> 306
// Swap 154 <-> 178
// Swap 155 <-> 434
// Swap 157 <-> 370
// Swap 158 <-> 242
// Swap 159 <-> 498
// Swap 161 <-> 266
// Swap 163 <-> 394
// Swap 165 <-> 330
// Swap 166 <-> 202
// Swap 167 <-> 458
// Swap 169 <-> 298
// Swap 171 <-> 426
// Swap 173 <-> 362
// Swap 174 <-> 234
// Swap 175 <-> 490
// Swap 177 <-> 282
// Swap 179 <-> 410
// Swap 181 <-> 346
// Swap 182 <-> 218
// Swap 183 <-> 474
// Swap 185 <-> 314
// Swap 187 <-> 442
// Swap 189 <-> 378
// Swap 190 <-> 250
// Swap 191 <-> 506
// Swap 193 <-> 262
// Swap 195 <-> 390
// Swap 197 <-> 326
// Swap 199 <-> 454
// Swap 201 <-> 294
// Swap 203 <-> 422
// Swap 205 <-> 358
// Swap 206 <-> 230
// Swap 207 <-> 486
// Swap 209 <-> 278
// Swap 211 <-> 406
// Swap 213 <-> 342
// Swap 215 <-> 470
// Swap 217 <-> 310
// Swap 219 <-> 438
// Swap 221 <-> 374
// Swap 222 <-> 246
// Swap 223 <-> 502
// Swap 225 <-> 270
// Swap 227 <-> 398
// Swap 229 <-> 334
// Swap 231 <-> 462
// Swap 233 <-> 302
// Swap 235 <-> 430
// Swap 237 <-> 366
// Swap 239 <-> 494
// Swap 241 <-> 286
// Swap 243 <-> 414
// Swap 245 <-> 350
// Swap 247 <-> 478
// Swap 249 <-> 318
// Swap 251 <-> 446
// Swap 253 <-> 382
// Swap 255 <-> 510
// Swap 259 <-> 385
// Swap 261 <-> 321
// Swap 263 <-> 449
// Swap 265 <-> 289
// Swap 267 <-> 417
// Swap 269 <-> 353
// Swap 271 <-> 481
// Swap 275 <-> 401
// Swap 277 <-> 337
// Swap 279 <-> 465
// Swap 281 <-> 305
// Swap 283 <-> 433
// Swap 285 <-> 369
// Swap 287 <-> 497
// Swap 291 <-> 393
// Swap 293 <-> 329
// Swap 295 <-> 457
// Swap 299 <-> 425
// Swap 301 <-> 361
// Swap 303 <-> 489
// Swap 307 <-> 409
// Swap 309 <-> 345
// Swap 311 <-> 473
// Swap 315 <-> 441
// Swap 317 <-> 377
// Swap 319 <-> 505
// Swap 323 <-> 389
// Swap 327 <-> 453
// Swap 331 <-> 421
// Swap 333 <-> 357
// Swap 335 <-> 485
// Swap 339 <-> 405
// Swap 343 <-> 469
// Swap 347 <-> 437
// Swap 349 <-> 373
// Swap 351 <-> 501
// Swap 355 <-> 397
// Swap 359 <-> 461
// Swap 363 <-> 429
// Swap 367 <-> 493
// Swap 371 <-> 413
// Swap 375 <-> 477
// Swap 379 <-> 445
// Swap 383 <-> 509
// Swap 391 <-> 451
// Swap 395 <-> 419
// Swap 399 <-> 483
// Swap 407 <-> 467
// Swap 411 <-> 435
// Swap 415 <-> 499
// Swap 423 <-> 459
// Swap 431 <-> 491
// Swap 439 <-> 475
// Swap 447 <-> 507
// Swap 463 <-> 487
// Swap 479 <-> 503

