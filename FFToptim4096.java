/**
 * Fast Fourier Transform - Optimized implementation for arrays of size 4096.
 * 
 * This class provides a highly optimized FFT implementation specifically designed
 * for 4096-element arrays using hardcoded bit-reversal lookup tables.
 * 
 * @author Orlando Selenu (original base algorithm, 2008)
 * @author Engine AI Assistant (optimized implementation, 2025)
 * @since 1.0
 */
public class FFToptim4096 {

    // Precomputed trigonometric lookup tables for 4096-point FFT
    private static final double[] COS_TABLE = new double[2048];
    private static final double[] SIN_TABLE = new double[2048];

    // Hardcoded bit-reversal swap pairs for optimal performance
    private static final int[][] BIT_REVERSAL_PAIRS = {
        {1, 2048},
        {2, 1024},
        {3, 3072},
        {4, 512},
        {5, 2560},
        {6, 1536},
        {7, 3584},
        {8, 256},
        {9, 2304},
        {10, 1280},
        {11, 3328},
        {12, 768},
        {13, 2816},
        {14, 1792},
        {15, 3840},
        {16, 128},
        {17, 2176},
        {18, 1152},
        {19, 3200},
        {20, 640},
        {21, 2688},
        {22, 1664},
        {23, 3712},
        {24, 384},
        {25, 2432},
        {26, 1408},
        {27, 3456},
        {28, 896},
        {29, 2944},
        {30, 1920},
        {31, 3968},
        {32, 64},
        {33, 2112},
        {34, 1088},
        {35, 3136},
        {36, 576},
        {37, 2624},
        {38, 1600},
        {39, 3648},
        {40, 320},
        {41, 2368},
        {42, 1344},
        {43, 3392},
        {44, 832},
        {45, 2880},
        {46, 1856},
        {47, 3904},
        {48, 192},
        {49, 2240},
        {50, 1216},
        {51, 3264},
        {52, 704},
        {53, 2752},
        {54, 1728},
        {55, 3776},
        {56, 448},
        {57, 2496},
        {58, 1472},
        {59, 3520},
        {60, 960},
        {61, 3008},
        {62, 1984},
        {63, 4032},
        {65, 2080},
        {66, 1056},
        {67, 3104},
        {68, 544},
        {69, 2592},
        {70, 1568},
        {71, 3616},
        {72, 288},
        {73, 2336},
        {74, 1312},
        {75, 3360},
        {76, 800},
        {77, 2848},
        {78, 1824},
        {79, 3872},
        {80, 160},
        {81, 2208},
        {82, 1184},
        {83, 3232},
        {84, 672},
        {85, 2720},
        {86, 1696},
        {87, 3744},
        {88, 416},
        {89, 2464},
        {90, 1440},
        {91, 3488},
        {92, 928},
        {93, 2976},
        {94, 1952},
        {95, 4000},
        {97, 2144},
        {98, 1120},
        {99, 3168},
        {100, 608},
        {101, 2656},
        {102, 1632},
        {103, 3680},
        {104, 352},
        {105, 2400},
        {106, 1376},
        {107, 3424},
        {108, 864},
        {109, 2912},
        {110, 1888},
        {111, 3936},
        {112, 224},
        {113, 2272},
        {114, 1248},
        {115, 3296},
        {116, 736},
        {117, 2784},
        {118, 1760},
        {119, 3808},
        {120, 480},
        {121, 2528},
        {122, 1504},
        {123, 3552},
        {124, 992},
        {125, 3040},
        {126, 2016},
        {127, 4064},
        {129, 2064},
        {130, 1040},
        {131, 3088},
        {132, 528},
        {133, 2576},
        {134, 1552},
        {135, 3600},
        {136, 272},
        {137, 2320},
        {138, 1296},
        {139, 3344},
        {140, 784},
        {141, 2832},
        {142, 1808},
        {143, 3856},
        {145, 2192},
        {146, 1168},
        {147, 3216},
        {148, 656},
        {149, 2704},
        {150, 1680},
        {151, 3728},
        {152, 400},
        {153, 2448},
        {154, 1424},
        {155, 3472},
        {156, 912},
        {157, 2960},
        {158, 1936},
        {159, 3984},
        {161, 2128},
        {162, 1104},
        {163, 3152},
        {164, 592},
        {165, 2640},
        {166, 1616},
        {167, 3664},
        {168, 336},
        {169, 2384},
        {170, 1360},
        {171, 3408},
        {172, 848},
        {173, 2896},
        {174, 1872},
        {175, 3920},
        {176, 208},
        {177, 2256},
        {178, 1232},
        {179, 3280},
        {180, 720},
        {181, 2768},
        {182, 1744},
        {183, 3792},
        {184, 464},
        {185, 2512},
        {186, 1488},
        {187, 3536},
        {188, 976},
        {189, 3024},
        {190, 2000},
        {191, 4048},
        {193, 2096},
        {194, 1072},
        {195, 3120},
        {196, 560},
        {197, 2608},
        {198, 1584},
        {199, 3632},
        {200, 304},
        {201, 2352},
        {202, 1328},
        {203, 3376},
        {204, 816},
        {205, 2864},
        {206, 1840},
        {207, 3888},
        {209, 2224},
        {210, 1200},
        {211, 3248},
        {212, 688},
        {213, 2736},
        {214, 1712},
        {215, 3760},
        {216, 432},
        {217, 2480},
        {218, 1456},
        {219, 3504},
        {220, 944},
        {221, 2992},
        {222, 1968},
        {223, 4016},
        {225, 2160},
        {226, 1136},
        {227, 3184},
        {228, 624},
        {229, 2672},
        {230, 1648},
        {231, 3696},
        {232, 368},
        {233, 2416},
        {234, 1392},
        {235, 3440},
        {236, 880},
        {237, 2928},
        {238, 1904},
        {239, 3952},
        {241, 2288},
        {242, 1264},
        {243, 3312},
        {244, 752},
        {245, 2800},
        {246, 1776},
        {247, 3824},
        {248, 496},
        {249, 2544},
        {250, 1520},
        {251, 3568},
        {252, 1008},
        {253, 3056},
        {254, 2032},
        {255, 4080},
        {257, 2056},
        {258, 1032},
        {259, 3080},
        {260, 520},
        {261, 2568},
        {262, 1544},
        {263, 3592},
        {265, 2312},
        {266, 1288},
        {267, 3336},
        {268, 776},
        {269, 2824},
        {270, 1800},
        {271, 3848},
        {273, 2184},
        {274, 1160},
        {275, 3208},
        {276, 648},
        {277, 2696},
        {278, 1672},
        {279, 3720},
        {280, 392},
        {281, 2440},
        {282, 1416},
        {283, 3464},
        {284, 904},
        {285, 2952},
        {286, 1928},
        {287, 3976},
        {289, 2120},
        {290, 1096},
        {291, 3144},
        {292, 584},
        {293, 2632},
        {294, 1608},
        {295, 3656},
        {296, 328},
        {297, 2376},
        {298, 1352},
        {299, 3400},
        {300, 840},
        {301, 2888},
        {302, 1864},
        {303, 3912},
        {305, 2248},
        {306, 1224},
        {307, 3272},
        {308, 712},
        {309, 2760},
        {310, 1736},
        {311, 3784},
        {312, 456},
        {313, 2504},
        {314, 1480},
        {315, 3528},
        {316, 968},
        {317, 3016},
        {318, 1992},
        {319, 4040},
        {321, 2088},
        {322, 1064},
        {323, 3112},
        {324, 552},
        {325, 2600},
        {326, 1576},
        {327, 3624},
        {329, 2344},
        {330, 1320},
        {331, 3368},
        {332, 808},
        {333, 2856},
        {334, 1832},
        {335, 3880},
        {337, 2216},
        {338, 1192},
        {339, 3240},
        {340, 680},
        {341, 2728},
        {342, 1704},
        {343, 3752},
        {344, 424},
        {345, 2472},
        {346, 1448},
        {347, 3496},
        {348, 936},
        {349, 2984},
        {350, 1960},
        {351, 4008},
        {353, 2152},
        {354, 1128},
        {355, 3176},
        {356, 616},
        {357, 2664},
        {358, 1640},
        {359, 3688},
        {361, 2408},
        {362, 1384},
        {363, 3432},
        {364, 872},
        {365, 2920},
        {366, 1896},
        {367, 3944},
        {369, 2280},
        {370, 1256},
        {371, 3304},
        {372, 744},
        {373, 2792},
        {374, 1768},
        {375, 3816},
        {376, 488},
        {377, 2536},
        {378, 1512},
        {379, 3560},
        {380, 1000},
        {381, 3048},
        {382, 2024},
        {383, 4072},
        {385, 2072},
        {386, 1048},
        {387, 3096},
        {388, 536},
        {389, 2584},
        {390, 1560},
        {391, 3608},
        {393, 2328},
        {394, 1304},
        {395, 3352},
        {396, 792},
        {397, 2840},
        {398, 1816},
        {399, 3864},
        {401, 2200},
        {402, 1176},
        {403, 3224},
        {404, 664},
        {405, 2712},
        {406, 1688},
        {407, 3736},
        {409, 2456},
        {410, 1432},
        {411, 3480},
        {412, 920},
        {413, 2968},
        {414, 1944},
        {415, 3992},
        {417, 2136},
        {418, 1112},
        {419, 3160},
        {420, 600},
        {421, 2648},
        {422, 1624},
        {423, 3672},
        {425, 2392},
        {426, 1368},
        {427, 3416},
        {428, 856},
        {429, 2904},
        {430, 1880},
        {431, 3928},
        {433, 2264},
        {434, 1240},
        {435, 3288},
        {436, 728},
        {437, 2776},
        {438, 1752},
        {439, 3800},
        {440, 472},
        {441, 2520},
        {442, 1496},
        {443, 3544},
        {444, 984},
        {445, 3032},
        {446, 2008},
        {447, 4056},
        {449, 2104},
        {450, 1080},
        {451, 3128},
        {452, 568},
        {453, 2616},
        {454, 1592},
        {455, 3640},
        {457, 2360},
        {458, 1336},
        {459, 3384},
        {460, 824},
        {461, 2872},
        {462, 1848},
        {463, 3896},
        {465, 2232},
        {466, 1208},
        {467, 3256},
        {468, 696},
        {469, 2744},
        {470, 1720},
        {471, 3768},
        {473, 2488},
        {474, 1464},
        {475, 3512},
        {476, 952},
        {477, 3000},
        {478, 1976},
        {479, 4024},
        {481, 2168},
        {482, 1144},
        {483, 3192},
        {484, 632},
        {485, 2680},
        {486, 1656},
        {487, 3704},
        {489, 2424},
        {490, 1400},
        {491, 3448},
        {492, 888},
        {493, 2936},
        {494, 1912},
        {495, 3960},
        {497, 2296},
        {498, 1272},
        {499, 3320},
        {500, 760},
        {501, 2808},
        {502, 1784},
        {503, 3832},
        {505, 2552},
        {506, 1528},
        {507, 3576},
        {508, 1016},
        {509, 3064},
        {510, 2040},
        {511, 4088},
        {513, 2052},
        {514, 1028},
        {515, 3076},
        {517, 2564},
        {518, 1540},
        {519, 3588},
        {521, 2308},
        {522, 1284},
        {523, 3332},
        {524, 772},
        {525, 2820},
        {526, 1796},
        {527, 3844},
        {529, 2180},
        {530, 1156},
        {531, 3204},
        {532, 644},
        {533, 2692},
        {534, 1668},
        {535, 3716},
        {537, 2436},
        {538, 1412},
        {539, 3460},
        {540, 900},
        {541, 2948},
        {542, 1924},
        {543, 3972},
        {545, 2116},
        {546, 1092},
        {547, 3140},
        {548, 580},
        {549, 2628},
        {550, 1604},
        {551, 3652},
        {553, 2372},
        {554, 1348},
        {555, 3396},
        {556, 836},
        {557, 2884},
        {558, 1860},
        {559, 3908},
        {561, 2244},
        {562, 1220},
        {563, 3268},
        {564, 708},
        {565, 2756},
        {566, 1732},
        {567, 3780},
        {569, 2500},
        {570, 1476},
        {571, 3524},
        {572, 964},
        {573, 3012},
        {574, 1988},
        {575, 4036},
        {577, 2084},
        {578, 1060},
        {579, 3108},
        {581, 2596},
        {582, 1572},
        {583, 3620},
        {585, 2340},
        {586, 1316},
        {587, 3364},
        {588, 804},
        {589, 2852},
        {590, 1828},
        {591, 3876},
        {593, 2212},
        {594, 1188},
        {595, 3236},
        {596, 676},
        {597, 2724},
        {598, 1700},
        {599, 3748},
        {601, 2468},
        {602, 1444},
        {603, 3492},
        {604, 932},
        {605, 2980},
        {606, 1956},
        {607, 4004},
        {609, 2148},
        {610, 1124},
        {611, 3172},
        {613, 2660},
        {614, 1636},
        {615, 3684},
        {617, 2404},
        {618, 1380},
        {619, 3428},
        {620, 868},
        {621, 2916},
        {622, 1892},
        {623, 3940},
        {625, 2276},
        {626, 1252},
        {627, 3300},
        {628, 740},
        {629, 2788},
        {630, 1764},
        {631, 3812},
        {633, 2532},
        {634, 1508},
        {635, 3556},
        {636, 996},
        {637, 3044},
        {638, 2020},
        {639, 4068},
        {641, 2068},
        {642, 1044},
        {643, 3092},
        {645, 2580},
        {646, 1556},
        {647, 3604},
        {649, 2324},
        {650, 1300},
        {651, 3348},
        {652, 788},
        {653, 2836},
        {654, 1812},
        {655, 3860},
        {657, 2196},
        {658, 1172},
        {659, 3220},
        {661, 2708},
        {662, 1684},
        {663, 3732},
        {665, 2452},
        {666, 1428},
        {667, 3476},
        {668, 916},
        {669, 2964},
        {670, 1940},
        {671, 3988},
        {673, 2132},
        {674, 1108},
        {675, 3156},
        {677, 2644},
        {678, 1620},
        {679, 3668},
        {681, 2388},
        {682, 1364},
        {683, 3412},
        {684, 852},
        {685, 2900},
        {686, 1876},
        {687, 3924},
        {689, 2260},
        {690, 1236},
        {691, 3284},
        {692, 724},
        {693, 2772},
        {694, 1748},
        {695, 3796},
        {697, 2516},
        {698, 1492},
        {699, 3540},
        {700, 980},
        {701, 3028},
        {702, 2004},
        {703, 4052},
        {705, 2100},
        {706, 1076},
        {707, 3124},
        {709, 2612},
        {710, 1588},
        {711, 3636},
        {713, 2356},
        {714, 1332},
        {715, 3380},
        {716, 820},
        {717, 2868},
        {718, 1844},
        {719, 3892},
        {721, 2228},
        {722, 1204},
        {723, 3252},
        {725, 2740},
        {726, 1716},
        {727, 3764},
        {729, 2484},
        {730, 1460},
        {731, 3508},
        {732, 948},
        {733, 2996},
        {734, 1972},
        {735, 4020},
        {737, 2164},
        {738, 1140},
        {739, 3188},
        {741, 2676},
        {742, 1652},
        {743, 3700},
        {745, 2420},
        {746, 1396},
        {747, 3444},
        {748, 884},
        {749, 2932},
        {750, 1908},
        {751, 3956},
        {753, 2292},
        {754, 1268},
        {755, 3316},
        {757, 2804},
        {758, 1780},
        {759, 3828},
        {761, 2548},
        {762, 1524},
        {763, 3572},
        {764, 1012},
        {765, 3060},
        {766, 2036},
        {767, 4084},
        {769, 2060},
        {770, 1036},
        {771, 3084},
        {773, 2572},
        {774, 1548},
        {775, 3596},
        {777, 2316},
        {778, 1292},
        {779, 3340},
        {781, 2828},
        {782, 1804},
        {783, 3852},
        {785, 2188},
        {786, 1164},
        {787, 3212},
        {789, 2700},
        {790, 1676},
        {791, 3724},
        {793, 2444},
        {794, 1420},
        {795, 3468},
        {796, 908},
        {797, 2956},
        {798, 1932},
        {799, 3980},
        {801, 2124},
        {802, 1100},
        {803, 3148},
        {805, 2636},
        {806, 1612},
        {807, 3660},
        {809, 2380},
        {810, 1356},
        {811, 3404},
        {812, 844},
        {813, 2892},
        {814, 1868},
        {815, 3916},
        {817, 2252},
        {818, 1228},
        {819, 3276},
        {821, 2764},
        {822, 1740},
        {823, 3788},
        {825, 2508},
        {826, 1484},
        {827, 3532},
        {828, 972},
        {829, 3020},
        {830, 1996},
        {831, 4044},
        {833, 2092},
        {834, 1068},
        {835, 3116},
        {837, 2604},
        {838, 1580},
        {839, 3628},
        {841, 2348},
        {842, 1324},
        {843, 3372},
        {845, 2860},
        {846, 1836},
        {847, 3884},
        {849, 2220},
        {850, 1196},
        {851, 3244},
        {853, 2732},
        {854, 1708},
        {855, 3756},
        {857, 2476},
        {858, 1452},
        {859, 3500},
        {860, 940},
        {861, 2988},
        {862, 1964},
        {863, 4012},
        {865, 2156},
        {866, 1132},
        {867, 3180},
        {869, 2668},
        {870, 1644},
        {871, 3692},
        {873, 2412},
        {874, 1388},
        {875, 3436},
        {877, 2924},
        {878, 1900},
        {879, 3948},
        {881, 2284},
        {882, 1260},
        {883, 3308},
        {885, 2796},
        {886, 1772},
        {887, 3820},
        {889, 2540},
        {890, 1516},
        {891, 3564},
        {892, 1004},
        {893, 3052},
        {894, 2028},
        {895, 4076},
        {897, 2076},
        {898, 1052},
        {899, 3100},
        {901, 2588},
        {902, 1564},
        {903, 3612},
        {905, 2332},
        {906, 1308},
        {907, 3356},
        {909, 2844},
        {910, 1820},
        {911, 3868},
        {913, 2204},
        {914, 1180},
        {915, 3228},
        {917, 2716},
        {918, 1692},
        {919, 3740},
        {921, 2460},
        {922, 1436},
        {923, 3484},
        {925, 2972},
        {926, 1948},
        {927, 3996},
        {929, 2140},
        {930, 1116},
        {931, 3164},
        {933, 2652},
        {934, 1628},
        {935, 3676},
        {937, 2396},
        {938, 1372},
        {939, 3420},
        {941, 2908},
        {942, 1884},
        {943, 3932},
        {945, 2268},
        {946, 1244},
        {947, 3292},
        {949, 2780},
        {950, 1756},
        {951, 3804},
        {953, 2524},
        {954, 1500},
        {955, 3548},
        {956, 988},
        {957, 3036},
        {958, 2012},
        {959, 4060},
        {961, 2108},
        {962, 1084},
        {963, 3132},
        {965, 2620},
        {966, 1596},
        {967, 3644},
        {969, 2364},
        {970, 1340},
        {971, 3388},
        {973, 2876},
        {974, 1852},
        {975, 3900},
        {977, 2236},
        {978, 1212},
        {979, 3260},
        {981, 2748},
        {982, 1724},
        {983, 3772},
        {985, 2492},
        {986, 1468},
        {987, 3516},
        {989, 3004},
        {990, 1980},
        {991, 4028},
        {993, 2172},
        {994, 1148},
        {995, 3196},
        {997, 2684},
        {998, 1660},
        {999, 3708},
        {1001, 2428},
        {1002, 1404},
        {1003, 3452},
        {1005, 2940},
        {1006, 1916},
        {1007, 3964},
        {1009, 2300},
        {1010, 1276},
        {1011, 3324},
        {1013, 2812},
        {1014, 1788},
        {1015, 3836},
        {1017, 2556},
        {1018, 1532},
        {1019, 3580},
        {1021, 3068},
        {1022, 2044},
        {1023, 4092},
        {1025, 2050},
        {1027, 3074},
        {1029, 2562},
        {1030, 1538},
        {1031, 3586},
        {1033, 2306},
        {1034, 1282},
        {1035, 3330},
        {1037, 2818},
        {1038, 1794},
        {1039, 3842},
        {1041, 2178},
        {1042, 1154},
        {1043, 3202},
        {1045, 2690},
        {1046, 1666},
        {1047, 3714},
        {1049, 2434},
        {1050, 1410},
        {1051, 3458},
        {1053, 2946},
        {1054, 1922},
        {1055, 3970},
        {1057, 2114},
        {1058, 1090},
        {1059, 3138},
        {1061, 2626},
        {1062, 1602},
        {1063, 3650},
        {1065, 2370},
        {1066, 1346},
        {1067, 3394},
        {1069, 2882},
        {1070, 1858},
        {1071, 3906},
        {1073, 2242},
        {1074, 1218},
        {1075, 3266},
        {1077, 2754},
        {1078, 1730},
        {1079, 3778},
        {1081, 2498},
        {1082, 1474},
        {1083, 3522},
        {1085, 3010},
        {1086, 1986},
        {1087, 4034},
        {1089, 2082},
        {1091, 3106},
        {1093, 2594},
        {1094, 1570},
        {1095, 3618},
        {1097, 2338},
        {1098, 1314},
        {1099, 3362},
        {1101, 2850},
        {1102, 1826},
        {1103, 3874},
        {1105, 2210},
        {1106, 1186},
        {1107, 3234},
        {1109, 2722},
        {1110, 1698},
        {1111, 3746},
        {1113, 2466},
        {1114, 1442},
        {1115, 3490},
        {1117, 2978},
        {1118, 1954},
        {1119, 4002},
        {1121, 2146},
        {1123, 3170},
        {1125, 2658},
        {1126, 1634},
        {1127, 3682},
        {1129, 2402},
        {1130, 1378},
        {1131, 3426},
        {1133, 2914},
        {1134, 1890},
        {1135, 3938},
        {1137, 2274},
        {1138, 1250},
        {1139, 3298},
        {1141, 2786},
        {1142, 1762},
        {1143, 3810},
        {1145, 2530},
        {1146, 1506},
        {1147, 3554},
        {1149, 3042},
        {1150, 2018},
        {1151, 4066},
        {1153, 2066},
        {1155, 3090},
        {1157, 2578},
        {1158, 1554},
        {1159, 3602},
        {1161, 2322},
        {1162, 1298},
        {1163, 3346},
        {1165, 2834},
        {1166, 1810},
        {1167, 3858},
        {1169, 2194},
        {1171, 3218},
        {1173, 2706},
        {1174, 1682},
        {1175, 3730},
        {1177, 2450},
        {1178, 1426},
        {1179, 3474},
        {1181, 2962},
        {1182, 1938},
        {1183, 3986},
        {1185, 2130},
        {1187, 3154},
        {1189, 2642},
        {1190, 1618},
        {1191, 3666},
        {1193, 2386},
        {1194, 1362},
        {1195, 3410},
        {1197, 2898},
        {1198, 1874},
        {1199, 3922},
        {1201, 2258},
        {1202, 1234},
        {1203, 3282},
        {1205, 2770},
        {1206, 1746},
        {1207, 3794},
        {1209, 2514},
        {1210, 1490},
        {1211, 3538},
        {1213, 3026},
        {1214, 2002},
        {1215, 4050},
        {1217, 2098},
        {1219, 3122},
        {1221, 2610},
        {1222, 1586},
        {1223, 3634},
        {1225, 2354},
        {1226, 1330},
        {1227, 3378},
        {1229, 2866},
        {1230, 1842},
        {1231, 3890},
        {1233, 2226},
        {1235, 3250},
        {1237, 2738},
        {1238, 1714},
        {1239, 3762},
        {1241, 2482},
        {1242, 1458},
        {1243, 3506},
        {1245, 2994},
        {1246, 1970},
        {1247, 4018},
        {1249, 2162},
        {1251, 3186},
        {1253, 2674},
        {1254, 1650},
        {1255, 3698},
        {1257, 2418},
        {1258, 1394},
        {1259, 3442},
        {1261, 2930},
        {1262, 1906},
        {1263, 3954},
        {1265, 2290},
        {1267, 3314},
        {1269, 2802},
        {1270, 1778},
        {1271, 3826},
        {1273, 2546},
        {1274, 1522},
        {1275, 3570},
        {1277, 3058},
        {1278, 2034},
        {1279, 4082},
        {1281, 2058},
        {1283, 3082},
        {1285, 2570},
        {1286, 1546},
        {1287, 3594},
        {1289, 2314},
        {1291, 3338},
        {1293, 2826},
        {1294, 1802},
        {1295, 3850},
        {1297, 2186},
        {1299, 3210},
        {1301, 2698},
        {1302, 1674},
        {1303, 3722},
        {1305, 2442},
        {1306, 1418},
        {1307, 3466},
        {1309, 2954},
        {1310, 1930},
        {1311, 3978},
        {1313, 2122},
        {1315, 3146},
        {1317, 2634},
        {1318, 1610},
        {1319, 3658},
        {1321, 2378},
        {1322, 1354},
        {1323, 3402},
        {1325, 2890},
        {1326, 1866},
        {1327, 3914},
        {1329, 2250},
        {1331, 3274},
        {1333, 2762},
        {1334, 1738},
        {1335, 3786},
        {1337, 2506},
        {1338, 1482},
        {1339, 3530},
        {1341, 3018},
        {1342, 1994},
        {1343, 4042},
        {1345, 2090},
        {1347, 3114},
        {1349, 2602},
        {1350, 1578},
        {1351, 3626},
        {1353, 2346},
        {1355, 3370},
        {1357, 2858},
        {1358, 1834},
        {1359, 3882},
        {1361, 2218},
        {1363, 3242},
        {1365, 2730},
        {1366, 1706},
        {1367, 3754},
        {1369, 2474},
        {1370, 1450},
        {1371, 3498},
        {1373, 2986},
        {1374, 1962},
        {1375, 4010},
        {1377, 2154},
        {1379, 3178},
        {1381, 2666},
        {1382, 1642},
        {1383, 3690},
        {1385, 2410},
        {1387, 3434},
        {1389, 2922},
        {1390, 1898},
        {1391, 3946},
        {1393, 2282},
        {1395, 3306},
        {1397, 2794},
        {1398, 1770},
        {1399, 3818},
        {1401, 2538},
        {1402, 1514},
        {1403, 3562},
        {1405, 3050},
        {1406, 2026},
        {1407, 4074},
        {1409, 2074},
        {1411, 3098},
        {1413, 2586},
        {1414, 1562},
        {1415, 3610},
        {1417, 2330},
        {1419, 3354},
        {1421, 2842},
        {1422, 1818},
        {1423, 3866},
        {1425, 2202},
        {1427, 3226},
        {1429, 2714},
        {1430, 1690},
        {1431, 3738},
        {1433, 2458},
        {1435, 3482},
        {1437, 2970},
        {1438, 1946},
        {1439, 3994},
        {1441, 2138},
        {1443, 3162},
        {1445, 2650},
        {1446, 1626},
        {1447, 3674},
        {1449, 2394},
        {1451, 3418},
        {1453, 2906},
        {1454, 1882},
        {1455, 3930},
        {1457, 2266},
        {1459, 3290},
        {1461, 2778},
        {1462, 1754},
        {1463, 3802},
        {1465, 2522},
        {1466, 1498},
        {1467, 3546},
        {1469, 3034},
        {1470, 2010},
        {1471, 4058},
        {1473, 2106},
        {1475, 3130},
        {1477, 2618},
        {1478, 1594},
        {1479, 3642},
        {1481, 2362},
        {1483, 3386},
        {1485, 2874},
        {1486, 1850},
        {1487, 3898},
        {1489, 2234},
        {1491, 3258},
        {1493, 2746},
        {1494, 1722},
        {1495, 3770},
        {1497, 2490},
        {1499, 3514},
        {1501, 3002},
        {1502, 1978},
        {1503, 4026},
        {1505, 2170},
        {1507, 3194},
        {1509, 2682},
        {1510, 1658},
        {1511, 3706},
        {1513, 2426},
        {1515, 3450},
        {1517, 2938},
        {1518, 1914},
        {1519, 3962},
        {1521, 2298},
        {1523, 3322},
        {1525, 2810},
        {1526, 1786},
        {1527, 3834},
        {1529, 2554},
        {1531, 3578},
        {1533, 3066},
        {1534, 2042},
        {1535, 4090},
        {1537, 2054},
        {1539, 3078},
        {1541, 2566},
        {1543, 3590},
        {1545, 2310},
        {1547, 3334},
        {1549, 2822},
        {1550, 1798},
        {1551, 3846},
        {1553, 2182},
        {1555, 3206},
        {1557, 2694},
        {1558, 1670},
        {1559, 3718},
        {1561, 2438},
        {1563, 3462},
        {1565, 2950},
        {1566, 1926},
        {1567, 3974},
        {1569, 2118},
        {1571, 3142},
        {1573, 2630},
        {1574, 1606},
        {1575, 3654},
        {1577, 2374},
        {1579, 3398},
        {1581, 2886},
        {1582, 1862},
        {1583, 3910},
        {1585, 2246},
        {1587, 3270},
        {1589, 2758},
        {1590, 1734},
        {1591, 3782},
        {1593, 2502},
        {1595, 3526},
        {1597, 3014},
        {1598, 1990},
        {1599, 4038},
        {1601, 2086},
        {1603, 3110},
        {1605, 2598},
        {1607, 3622},
        {1609, 2342},
        {1611, 3366},
        {1613, 2854},
        {1614, 1830},
        {1615, 3878},
        {1617, 2214},
        {1619, 3238},
        {1621, 2726},
        {1622, 1702},
        {1623, 3750},
        {1625, 2470},
        {1627, 3494},
        {1629, 2982},
        {1630, 1958},
        {1631, 4006},
        {1633, 2150},
        {1635, 3174},
        {1637, 2662},
        {1639, 3686},
        {1641, 2406},
        {1643, 3430},
        {1645, 2918},
        {1646, 1894},
        {1647, 3942},
        {1649, 2278},
        {1651, 3302},
        {1653, 2790},
        {1654, 1766},
        {1655, 3814},
        {1657, 2534},
        {1659, 3558},
        {1661, 3046},
        {1662, 2022},
        {1663, 4070},
        {1665, 2070},
        {1667, 3094},
        {1669, 2582},
        {1671, 3606},
        {1673, 2326},
        {1675, 3350},
        {1677, 2838},
        {1678, 1814},
        {1679, 3862},
        {1681, 2198},
        {1683, 3222},
        {1685, 2710},
        {1687, 3734},
        {1689, 2454},
        {1691, 3478},
        {1693, 2966},
        {1694, 1942},
        {1695, 3990},
        {1697, 2134},
        {1699, 3158},
        {1701, 2646},
        {1703, 3670},
        {1705, 2390},
        {1707, 3414},
        {1709, 2902},
        {1710, 1878},
        {1711, 3926},
        {1713, 2262},
        {1715, 3286},
        {1717, 2774},
        {1718, 1750},
        {1719, 3798},
        {1721, 2518},
        {1723, 3542},
        {1725, 3030},
        {1726, 2006},
        {1727, 4054},
        {1729, 2102},
        {1731, 3126},
        {1733, 2614},
        {1735, 3638},
        {1737, 2358},
        {1739, 3382},
        {1741, 2870},
        {1742, 1846},
        {1743, 3894},
        {1745, 2230},
        {1747, 3254},
        {1749, 2742},
        {1751, 3766},
        {1753, 2486},
        {1755, 3510},
        {1757, 2998},
        {1758, 1974},
        {1759, 4022},
        {1761, 2166},
        {1763, 3190},
        {1765, 2678},
        {1767, 3702},
        {1769, 2422},
        {1771, 3446},
        {1773, 2934},
        {1774, 1910},
        {1775, 3958},
        {1777, 2294},
        {1779, 3318},
        {1781, 2806},
        {1783, 3830},
        {1785, 2550},
        {1787, 3574},
        {1789, 3062},
        {1790, 2038},
        {1791, 4086},
        {1793, 2062},
        {1795, 3086},
        {1797, 2574},
        {1799, 3598},
        {1801, 2318},
        {1803, 3342},
        {1805, 2830},
        {1807, 3854},
        {1809, 2190},
        {1811, 3214},
        {1813, 2702},
        {1815, 3726},
        {1817, 2446},
        {1819, 3470},
        {1821, 2958},
        {1822, 1934},
        {1823, 3982},
        {1825, 2126},
        {1827, 3150},
        {1829, 2638},
        {1831, 3662},
        {1833, 2382},
        {1835, 3406},
        {1837, 2894},
        {1838, 1870},
        {1839, 3918},
        {1841, 2254},
        {1843, 3278},
        {1845, 2766},
        {1847, 3790},
        {1849, 2510},
        {1851, 3534},
        {1853, 3022},
        {1854, 1998},
        {1855, 4046},
        {1857, 2094},
        {1859, 3118},
        {1861, 2606},
        {1863, 3630},
        {1865, 2350},
        {1867, 3374},
        {1869, 2862},
        {1871, 3886},
        {1873, 2222},
        {1875, 3246},
        {1877, 2734},
        {1879, 3758},
        {1881, 2478},
        {1883, 3502},
        {1885, 2990},
        {1886, 1966},
        {1887, 4014},
        {1889, 2158},
        {1891, 3182},
        {1893, 2670},
        {1895, 3694},
        {1897, 2414},
        {1899, 3438},
        {1901, 2926},
        {1903, 3950},
        {1905, 2286},
        {1907, 3310},
        {1909, 2798},
        {1911, 3822},
        {1913, 2542},
        {1915, 3566},
        {1917, 3054},
        {1918, 2030},
        {1919, 4078},
        {1921, 2078},
        {1923, 3102},
        {1925, 2590},
        {1927, 3614},
        {1929, 2334},
        {1931, 3358},
        {1933, 2846},
        {1935, 3870},
        {1937, 2206},
        {1939, 3230},
        {1941, 2718},
        {1943, 3742},
        {1945, 2462},
        {1947, 3486},
        {1949, 2974},
        {1951, 3998},
        {1953, 2142},
        {1955, 3166},
        {1957, 2654},
        {1959, 3678},
        {1961, 2398},
        {1963, 3422},
        {1965, 2910},
        {1967, 3934},
        {1969, 2270},
        {1971, 3294},
        {1973, 2782},
        {1975, 3806},
        {1977, 2526},
        {1979, 3550},
        {1981, 3038},
        {1982, 2014},
        {1983, 4062},
        {1985, 2110},
        {1987, 3134},
        {1989, 2622},
        {1991, 3646},
        {1993, 2366},
        {1995, 3390},
        {1997, 2878},
        {1999, 3902},
        {2001, 2238},
        {2003, 3262},
        {2005, 2750},
        {2007, 3774},
        {2009, 2494},
        {2011, 3518},
        {2013, 3006},
        {2015, 4030},
        {2017, 2174},
        {2019, 3198},
        {2021, 2686},
        {2023, 3710},
        {2025, 2430},
        {2027, 3454},
        {2029, 2942},
        {2031, 3966},
        {2033, 2302},
        {2035, 3326},
        {2037, 2814},
        {2039, 3838},
        {2041, 2558},
        {2043, 3582},
        {2045, 3070},
        {2047, 4094},
        {2051, 3073},
        {2053, 2561},
        {2055, 3585},
        {2057, 2305},
        {2059, 3329},
        {2061, 2817},
        {2063, 3841},
        {2065, 2177},
        {2067, 3201},
        {2069, 2689},
        {2071, 3713},
        {2073, 2433},
        {2075, 3457},
        {2077, 2945},
        {2079, 3969},
        {2081, 2113},
        {2083, 3137},
        {2085, 2625},
        {2087, 3649},
        {2089, 2369},
        {2091, 3393},
        {2093, 2881},
        {2095, 3905},
        {2097, 2241},
        {2099, 3265},
        {2101, 2753},
        {2103, 3777},
        {2105, 2497},
        {2107, 3521},
        {2109, 3009},
        {2111, 4033},
        {2115, 3105},
        {2117, 2593},
        {2119, 3617},
        {2121, 2337},
        {2123, 3361},
        {2125, 2849},
        {2127, 3873},
        {2129, 2209},
        {2131, 3233},
        {2133, 2721},
        {2135, 3745},
        {2137, 2465},
        {2139, 3489},
        {2141, 2977},
        {2143, 4001},
        {2147, 3169},
        {2149, 2657},
        {2151, 3681},
        {2153, 2401},
        {2155, 3425},
        {2157, 2913},
        {2159, 3937},
        {2161, 2273},
        {2163, 3297},
        {2165, 2785},
        {2167, 3809},
        {2169, 2529},
        {2171, 3553},
        {2173, 3041},
        {2175, 4065},
        {2179, 3089},
        {2181, 2577},
        {2183, 3601},
        {2185, 2321},
        {2187, 3345},
        {2189, 2833},
        {2191, 3857},
        {2195, 3217},
        {2197, 2705},
        {2199, 3729},
        {2201, 2449},
        {2203, 3473},
        {2205, 2961},
        {2207, 3985},
        {2211, 3153},
        {2213, 2641},
        {2215, 3665},
        {2217, 2385},
        {2219, 3409},
        {2221, 2897},
        {2223, 3921},
        {2225, 2257},
        {2227, 3281},
        {2229, 2769},
        {2231, 3793},
        {2233, 2513},
        {2235, 3537},
        {2237, 3025},
        {2239, 4049},
        {2243, 3121},
        {2245, 2609},
        {2247, 3633},
        {2249, 2353},
        {2251, 3377},
        {2253, 2865},
        {2255, 3889},
        {2259, 3249},
        {2261, 2737},
        {2263, 3761},
        {2265, 2481},
        {2267, 3505},
        {2269, 2993},
        {2271, 4017},
        {2275, 3185},
        {2277, 2673},
        {2279, 3697},
        {2281, 2417},
        {2283, 3441},
        {2285, 2929},
        {2287, 3953},
        {2291, 3313},
        {2293, 2801},
        {2295, 3825},
        {2297, 2545},
        {2299, 3569},
        {2301, 3057},
        {2303, 4081},
        {2307, 3081},
        {2309, 2569},
        {2311, 3593},
        {2315, 3337},
        {2317, 2825},
        {2319, 3849},
        {2323, 3209},
        {2325, 2697},
        {2327, 3721},
        {2329, 2441},
        {2331, 3465},
        {2333, 2953},
        {2335, 3977},
        {2339, 3145},
        {2341, 2633},
        {2343, 3657},
        {2345, 2377},
        {2347, 3401},
        {2349, 2889},
        {2351, 3913},
        {2355, 3273},
        {2357, 2761},
        {2359, 3785},
        {2361, 2505},
        {2363, 3529},
        {2365, 3017},
        {2367, 4041},
        {2371, 3113},
        {2373, 2601},
        {2375, 3625},
        {2379, 3369},
        {2381, 2857},
        {2383, 3881},
        {2387, 3241},
        {2389, 2729},
        {2391, 3753},
        {2393, 2473},
        {2395, 3497},
        {2397, 2985},
        {2399, 4009},
        {2403, 3177},
        {2405, 2665},
        {2407, 3689},
        {2411, 3433},
        {2413, 2921},
        {2415, 3945},
        {2419, 3305},
        {2421, 2793},
        {2423, 3817},
        {2425, 2537},
        {2427, 3561},
        {2429, 3049},
        {2431, 4073},
        {2435, 3097},
        {2437, 2585},
        {2439, 3609},
        {2443, 3353},
        {2445, 2841},
        {2447, 3865},
        {2451, 3225},
        {2453, 2713},
        {2455, 3737},
        {2459, 3481},
        {2461, 2969},
        {2463, 3993},
        {2467, 3161},
        {2469, 2649},
        {2471, 3673},
        {2475, 3417},
        {2477, 2905},
        {2479, 3929},
        {2483, 3289},
        {2485, 2777},
        {2487, 3801},
        {2489, 2521},
        {2491, 3545},
        {2493, 3033},
        {2495, 4057},
        {2499, 3129},
        {2501, 2617},
        {2503, 3641},
        {2507, 3385},
        {2509, 2873},
        {2511, 3897},
        {2515, 3257},
        {2517, 2745},
        {2519, 3769},
        {2523, 3513},
        {2525, 3001},
        {2527, 4025},
        {2531, 3193},
        {2533, 2681},
        {2535, 3705},
        {2539, 3449},
        {2541, 2937},
        {2543, 3961},
        {2547, 3321},
        {2549, 2809},
        {2551, 3833},
        {2555, 3577},
        {2557, 3065},
        {2559, 4089},
        {2563, 3077},
        {2567, 3589},
        {2571, 3333},
        {2573, 2821},
        {2575, 3845},
        {2579, 3205},
        {2581, 2693},
        {2583, 3717},
        {2587, 3461},
        {2589, 2949},
        {2591, 3973},
        {2595, 3141},
        {2597, 2629},
        {2599, 3653},
        {2603, 3397},
        {2605, 2885},
        {2607, 3909},
        {2611, 3269},
        {2613, 2757},
        {2615, 3781},
        {2619, 3525},
        {2621, 3013},
        {2623, 4037},
        {2627, 3109},
        {2631, 3621},
        {2635, 3365},
        {2637, 2853},
        {2639, 3877},
        {2643, 3237},
        {2645, 2725},
        {2647, 3749},
        {2651, 3493},
        {2653, 2981},
        {2655, 4005},
        {2659, 3173},
        {2663, 3685},
        {2667, 3429},
        {2669, 2917},
        {2671, 3941},
        {2675, 3301},
        {2677, 2789},
        {2679, 3813},
        {2683, 3557},
        {2685, 3045},
        {2687, 4069},
        {2691, 3093},
        {2695, 3605},
        {2699, 3349},
        {2701, 2837},
        {2703, 3861},
        {2707, 3221},
        {2711, 3733},
        {2715, 3477},
        {2717, 2965},
        {2719, 3989},
        {2723, 3157},
        {2727, 3669},
        {2731, 3413},
        {2733, 2901},
        {2735, 3925},
        {2739, 3285},
        {2741, 2773},
        {2743, 3797},
        {2747, 3541},
        {2749, 3029},
        {2751, 4053},
        {2755, 3125},
        {2759, 3637},
        {2763, 3381},
        {2765, 2869},
        {2767, 3893},
        {2771, 3253},
        {2775, 3765},
        {2779, 3509},
        {2781, 2997},
        {2783, 4021},
        {2787, 3189},
        {2791, 3701},
        {2795, 3445},
        {2797, 2933},
        {2799, 3957},
        {2803, 3317},
        {2807, 3829},
        {2811, 3573},
        {2813, 3061},
        {2815, 4085},
        {2819, 3085},
        {2823, 3597},
        {2827, 3341},
        {2831, 3853},
        {2835, 3213},
        {2839, 3725},
        {2843, 3469},
        {2845, 2957},
        {2847, 3981},
        {2851, 3149},
        {2855, 3661},
        {2859, 3405},
        {2861, 2893},
        {2863, 3917},
        {2867, 3277},
        {2871, 3789},
        {2875, 3533},
        {2877, 3021},
        {2879, 4045},
        {2883, 3117},
        {2887, 3629},
        {2891, 3373},
        {2895, 3885},
        {2899, 3245},
        {2903, 3757},
        {2907, 3501},
        {2909, 2989},
        {2911, 4013},
        {2915, 3181},
        {2919, 3693},
        {2923, 3437},
        {2927, 3949},
        {2931, 3309},
        {2935, 3821},
        {2939, 3565},
        {2941, 3053},
        {2943, 4077},
        {2947, 3101},
        {2951, 3613},
        {2955, 3357},
        {2959, 3869},
        {2963, 3229},
        {2967, 3741},
        {2971, 3485},
        {2975, 3997},
        {2979, 3165},
        {2983, 3677},
        {2987, 3421},
        {2991, 3933},
        {2995, 3293},
        {2999, 3805},
        {3003, 3549},
        {3005, 3037},
        {3007, 4061},
        {3011, 3133},
        {3015, 3645},
        {3019, 3389},
        {3023, 3901},
        {3027, 3261},
        {3031, 3773},
        {3035, 3517},
        {3039, 4029},
        {3043, 3197},
        {3047, 3709},
        {3051, 3453},
        {3055, 3965},
        {3059, 3325},
        {3063, 3837},
        {3067, 3581},
        {3071, 4093},
        {3079, 3587},
        {3083, 3331},
        {3087, 3843},
        {3091, 3203},
        {3095, 3715},
        {3099, 3459},
        {3103, 3971},
        {3107, 3139},
        {3111, 3651},
        {3115, 3395},
        {3119, 3907},
        {3123, 3267},
        {3127, 3779},
        {3131, 3523},
        {3135, 4035},
        {3143, 3619},
        {3147, 3363},
        {3151, 3875},
        {3155, 3235},
        {3159, 3747},
        {3163, 3491},
        {3167, 4003},
        {3175, 3683},
        {3179, 3427},
        {3183, 3939},
        {3187, 3299},
        {3191, 3811},
        {3195, 3555},
        {3199, 4067},
        {3207, 3603},
        {3211, 3347},
        {3215, 3859},
        {3223, 3731},
        {3227, 3475},
        {3231, 3987},
        {3239, 3667},
        {3243, 3411},
        {3247, 3923},
        {3251, 3283},
        {3255, 3795},
        {3259, 3539},
        {3263, 4051},
        {3271, 3635},
        {3275, 3379},
        {3279, 3891},
        {3287, 3763},
        {3291, 3507},
        {3295, 4019},
        {3303, 3699},
        {3307, 3443},
        {3311, 3955},
        {3319, 3827},
        {3323, 3571},
        {3327, 4083},
        {3335, 3595},
        {3343, 3851},
        {3351, 3723},
        {3355, 3467},
        {3359, 3979},
        {3367, 3659},
        {3371, 3403},
        {3375, 3915},
        {3383, 3787},
        {3387, 3531},
        {3391, 4043},
        {3399, 3627},
        {3407, 3883},
        {3415, 3755},
        {3419, 3499},
        {3423, 4011},
        {3431, 3691},
        {3439, 3947},
        {3447, 3819},
        {3451, 3563},
        {3455, 4075},
        {3463, 3611},
        {3471, 3867},
        {3479, 3739},
        {3487, 3995},
        {3495, 3675},
        {3503, 3931},
        {3511, 3803},
        {3515, 3547},
        {3519, 4059},
        {3527, 3643},
        {3535, 3899},
        {3543, 3771},
        {3551, 4027},
        {3559, 3707},
        {3567, 3963},
        {3575, 3835},
        {3583, 4091},
        {3599, 3847},
        {3607, 3719},
        {3615, 3975},
        {3623, 3655},
        {3631, 3911},
        {3639, 3783},
        {3647, 4039},
        {3663, 3879},
        {3671, 3751},
        {3679, 4007},
        {3695, 3943},
        {3703, 3815},
        {3711, 4071},
        {3727, 3863},
        {3743, 3991},
        {3759, 3927},
        {3767, 3799},
        {3775, 4055},
        {3791, 3895},
        {3807, 4023},
        {3823, 3959},
        {3839, 4087},
        {3871, 3983},
        {3887, 3919},
        {3903, 4047},
        {3935, 4015},
        {3967, 4079},
        {4031, 4063}
    };

    static {
        // Initialize trigonometric lookup tables
        for (int i = 0; i < 2048; i++) {
            double angle = 2.0 * Math.PI * i / 4096.0;
            COS_TABLE[i] = Math.cos(angle);
            SIN_TABLE[i] = Math.sin(angle);
        }
    }

    /**
     * Performs Fast Fourier Transform optimized for 4096-element arrays.
     * 
     * @param inputReal array of exactly 4096 real values
     * @param inputImag array of exactly 4096 imaginary values
     * @param DIRECT true for forward transform, false for inverse
     * @return array of length 8192 with interleaved real and imaginary results
     */
    public static double[] fft(final double[] inputReal, double[] inputImag, boolean DIRECT) {
        // Validate input size
        if (inputReal.length != 4096 || inputImag.length != 4096) {
            System.out.println("ERROR: Input arrays must be exactly size 4096");
            return new double[0];
        }

        // Hardcoded parameters for size 4096
        final int n = 4096;
        final int nu = 12;
        int n2 = 2048;
        int nu1 = 11;
        double[] xReal = new double[n];
        double[] xImag = new double[n];
        double tReal, tImag;

        // Copy input arrays
        System.arraycopy(inputReal, 0, xReal, 0, n);
        System.arraycopy(inputImag, 0, xImag, 0, n);

        // FFT butterfly computation stages
        int k = 0;
        for (int l = 1; l <= nu; l++) {
            while (k < n) {
                for (int i = 1; i <= n2; i++) {
                    int p_index = k >> nu1;
                    double c, s;
                    if (p_index < 2048) {
                        c = DIRECT ? COS_TABLE[p_index] : COS_TABLE[p_index];
                        s = DIRECT ? -SIN_TABLE[p_index] : SIN_TABLE[p_index];
                    } else {
                        c = 1.0; s = 0.0;
                    }
                    tReal = xReal[k + n2] * c + xImag[k + n2] * s;
                    tImag = xImag[k + n2] * c - xReal[k + n2] * s;
                    xReal[k + n2] = xReal[k] - tReal;
                    xImag[k + n2] = xImag[k] - tImag;
                    xReal[k] += tReal;
                    xImag[k] += tImag;
                    k++;
                }
                k += n2;
            }
            k = 0; nu1--; n2 /= 2;
        }

        // Final bit-reversal reordering using hardcoded lookup table
        for (int[] pair : BIT_REVERSAL_PAIRS) {
            int i = pair[0], j = pair[1];
            tReal = xReal[i]; tImag = xImag[i];
            xReal[i] = xReal[j]; xImag[i] = xImag[j];
            xReal[j] = tReal; xImag[j] = tImag;
        }

        // Generate interleaved output with normalization
        double[] result = new double[8192];
        double radice = 1.0 / Math.sqrt(n);
        for (int i = 0; i < n; i++) {
            result[2 * i] = xReal[i] * radice;
            result[2 * i + 1] = xImag[i] * radice;
        }
        return result;
    }
}
